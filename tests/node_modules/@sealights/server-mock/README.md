# Agents Mock Server
Mock Server and Configuration web app for testing agents
## Quick Start
1. Install packages: `npm install`
2. Run server: `npm run start:server`
3. Build web app: `npx webpack`
4. Web app in browser: `localhost:9900`
## Folders and Files
* `src`: all source code
* `src\client`: web app source code
* `src\data`: routes (and other future data)
* `dist`: compiled server code
* `web`: compiled web app
## Routes
All routes (endpoints) are in `src\data\routes.json`. Each route has the following properties:
* `method`: GET, POST, etc.
* `url`: the url - same as the first argument of `express`'s `app.get()`, `app.post()` etc.

To add/edit or reorder the routes, edit this file and then refresh the web app
## Route Configuration
The web app enables the configuration of all the routes. Each route can:
* Reset: behave as programmed
* Set status: return custom status
* [Optional] Repeat custom status: return custom status N times, and then behave as programmed
## Saved Configurations
The web app provides saving configuration to file, and later loading any previously saved configuration. Configuration files are saved in JSON format. The following buttons are available:
* Load Configuration: open file dialog and select previously saved configuration file
* Save Configuration: save the current configuration to file (the file is saved in the browser's download folder)
* Reset Configuration: reset all route configurations (no custom behavior)

**Note: only JSON files can be loaded, but their actual schema is not validated**

PUBLISH PROCEDURE
-----------------
1. Commit and push the new version change to the git repository.
2. run `npm run build`.
3. run `npm run publish:package`.
    3.1 If not logged in, login with `npm login --registry http://nex.sealights.co:8081/repository/sealights-internal-npm/`
        user: sealights, pwd - ask for somebody

Working with DEV version
-----------------
1. run `npm run build`.
2. run `npm pack`. 
This will create and archive sealights-server-mock-<version>.tgz
3. Open the explorer and copy the path to the created archive.
4. open a terminal to mock server client (in case of java-agent - terminal to the project root folder) and run
`npm install "path/to/sealights-server-mock-<version>.tgz"`
